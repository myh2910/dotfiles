# This file has been auto-generated by i3-config-wizard(1).
# It will not be overwritten, so edit it as you like.
#
# Should you change your keyboard layout some time, delete
# this file and re-run i3-config-wizard(1).



# i3 config file (v4)
#
# Please see http://i3wm.org/docs/userguide.html for a complete reference!

set $mod Mod4

# Font for window titles. Will also be used by the bar unless a different font
# is used in the bar {} block below (it is).
font pango:DejaVu Sans Mono 11
# font pango:Inconsolata 11

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod


# close focused window
# we implement this in a separate mode as a sort of confirmation
# (and so that if we hold down the key by accident nothing happens
bindsym $mod+q mode "close"
mode "close" {
    bindsym Return kill window, mode "default"
    bindsym Escape mode "default"
}

# start dmenu (a program launcher)
# bindsym $mod+d exec dmenu_run
# There also is the (new) i3-dmenu-desktop which only displays applications
# shipping a .desktop file. It is a wrapper around dmenu, so you need that
# installed.
# bindsym $mod+d exec --no-startup-id i3-dmenu-desktop --entry-type=filename
bindsym $mod+d exec --no-startup-id rofi -modi drun#run -show drun -show-icons
bindsym $mod+c exec --no-startup-id clipmenu -i
bindsym $mod+w exec --no-startup-id rofi -modi window -show window

# change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

#bindsym $mod+Left  workspace prev
#bindsym $mod+Right workspace next

# move focused window
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

# alternatively, you can use the cursor keys:
bindsym $mod+Shift+Left  move workspace to output left;
bindsym $mod+Shift+Right move workspace to output right;

# split in horizontal orientation
bindsym $mod+z split h
# split in vertical orientation
bindsym $mod+v split v

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+t layout tabbed
bindsym $mod+n layout toggle split
bindsym $mod+s layout stacking

# toggle tiling / floating
bindsym $mod+period floating toggle

# change focus between tiling / floating windows
bindsym $mod+Tab focus mode_toggle

# focus the parent container
bindsym $mod+a focus parent

# focus the child container
bindsym $mod+b focus child

# scratchpad commands
bindsym $mod+minus move scratchpad
bindsym $mod+u scratchpad show

# set workspace varnames
set $WS1 "1: Aleph"
set $WS2 "2: Bet"
set $WS3 "3: Gimel"
set $WS4 "4: Dalet"
set $WS5 "5: Hei"
set $WS6 "6: Vav"
set $WS7 "7: Zayin"
set $WS8 "8: Het"
set $WS9 "9: Tet"
set $WS0 "10: Yod"

# switch to workspace
bindsym $mod+1 workspace $WS1
bindsym $mod+2 workspace $WS2
bindsym $mod+3 workspace $WS3
bindsym $mod+4 workspace $WS4
bindsym $mod+5 workspace $WS5
bindsym $mod+6 workspace $WS6
bindsym $mod+7 workspace $WS7
bindsym $mod+8 workspace $WS8
bindsym $mod+9 workspace $WS9
bindsym $mod+0 workspace $WS0

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace $WS1; workspace $WS1
bindsym $mod+Shift+2 move container to workspace $WS2; workspace $WS2
bindsym $mod+Shift+3 move container to workspace $WS3; workspace $WS3
bindsym $mod+Shift+4 move container to workspace $WS4; workspace $WS4
bindsym $mod+Shift+5 move container to workspace $WS5; workspace $WS5
bindsym $mod+Shift+6 move container to workspace $WS6; workspace $WS6
bindsym $mod+Shift+7 move container to workspace $WS7; workspace $WS7
bindsym $mod+Shift+8 move container to workspace $WS8; workspace $WS8
bindsym $mod+Shift+9 move container to workspace $WS9; workspace $WS9
bindsym $mod+Shift+0 move container to workspace $WS0; workspace $WS0

# for_window commands
# to be added

# # resize window (you can also use the mouse for that)
# mode "resize" {
#     # These bindings trigger as soon as you enter the resize mode
#     bindsym k resize grow height 5 px or 5 ppt
#     bindsym j resize shrink height 5 px or 5 ppt
#     bindsym l resize grow width 5 px or 5 ppt
#     bindsym h resize shrink width 5 px or 5 ppt
#
#     # same bindings, but for the arrow keys
#     bindsym Up resize grow height 15 px or 15 ppt
#     bindsym Down resize shrink height 15 px or 15 ppt
#     bindsym Right resize grow width 15 px or 15 ppt
#     bindsym Left resize shrink width 15 px or 15 ppt
#
#     # back to normal: Enter or Escape
#     bindsym Return mode "default"
#     bindsym Escape mode "default"
# }
#
# bindsym $mod+r mode "resize"

# move windows around
mode "move" {
    bindsym h move left
    bindsym j move down
    bindsym k move up
    bindsym l move right

    # wider, narrower, shorter, taller
    bindsym w resize grow width 5 px or 5 ppt
    bindsym n resize shrink width 5 px or 5 ppt
    bindsym s resize shrink height 5 px or 5 ppt
    bindsym t resize grow height 5 px or 5 ppt

    bindsym Left move workspace to output left
    bindsym Down move workspace to output down
    bindsym Up move workspace to output up
    bindsym Right move workspace to output right

    bindsym 0 move container to workspace $WS0; workspace $WS0;
    bindsym 1 move container to workspace $WS1; workspace $WS1;
    bindsym 2 move container to workspace $WS2; workspace $WS2;
    bindsym 3 move container to workspace $WS3; workspace $WS3;
    bindsym 4 move container to workspace $WS4; workspace $WS4;
    bindsym 5 move container to workspace $WS5; workspace $WS5;
    bindsym 6 move container to workspace $WS6; workspace $WS6;
    bindsym 7 move container to workspace $WS7; workspace $WS7;
    bindsym 8 move container to workspace $WS8; workspace $WS8;
    bindsym 9 move container to workspace $WS9; workspace $WS9;

    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+m mode "move"

# power mode
mode "danger" {
    bindsym e exec --no-startup-id i3-msg exit
    bindsym n exec --no-startup-id systemctl suspend, mode "default"
    bindsym s exec --no-startup-id systemctl poweroff
    bindsym z exec --no-startup-id systemctl reboot

    # for ArchMajestic: reset X-screen setup
    bindsym x exec --no-startup-id xrandr \
        --output "DP-4" --primary \
        --output "DP-0" --right-of "DP-4" \
        --output "HDMI-0" --below "DP-0" \
        --output "DP-2" --right-of "DP-0"

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+backslash mode "danger"

# config/reset mode
mode "config" {
    # reload the configuration file
    bindsym r reload, mode "default"
    # restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
    bindsym i restart, mode "default"
    bindsym m exec --no-startup-id $HOME/dotfiles/sh-scripts/redo-keys.sh, mode "default"

    # switch mouse buttons
    bindsym h exec --no-startup-id notify-send -i format-justify-left-symbolic \
        "Left hand mouse" "$(xmodmap -e \"pointer = 3 2 1\" 2>&1)",\
         mode "default"
    bindsym l exec --no-startup-id notify-send -i format-justify-right-symbolic \
        "Right hand mouse" "$(xmodmap -e \"pointer = 1 2 3\" 2>&1)", \
        mode "default"

    # starcraft mode
    bindsym s exec --no-startup-id notify-send -i starred-symbolic "SC2 mode glhf" \
        "$(xmodmap -e \"pointer = 1 2 3\" 2>&1)\n$(xset r rate 150 40 2>&1)", \
         mode "default"
    # normal mode
    bindsym n exec --no-startup-id notify-send -i mail-replied-symbolic \
        "Normal mode gg no re" "$(xmodmap -e \"pointer = 3 2 1\" 2>&1)\n$(xset r rate 660 25 2>&1)", \
         mode "default"

    bindsym p exec xfconf-query -c xfce4-power-manager \
        -p /xfce4-power-manager/presentation-mode -T \
        && notify-send -i dialog-information "xfce4 power manager presentation mode" \
        "$(xfconf-query -c xfce4-power-manager -p /xfce4-power-manager/presentation-mode)", \
        mode "default"

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+Escape mode "config"

# audio control mode
mode "ponymix" {
    #query
    bindsym q exec --no-startup-id notify-send -i audio-card "Audio query" "$(ponymix)" -t 5000

    # switching audio
    bindsym e exec --no-startup-id $HOME/dotfiles/sh-scripts/paswitch.sh usb, mode "default"
    bindsym s exec --no-startup-id $HOME/dotfiles/sh-scripts/paswitch.sh speakers, mode "default"
    # bindsym b exec --no-startup-id $HOME/dotfiles/sh-scripts/paswitch.sh hdmi, mode "default"

    # mic volume
    bindsym u exec --no-startup-id notify-send -i microphone-sensitivity-high-symbolic "Mic volume up" "Current mic volume $(ponymix -t source increase 4)%" -t 5000
    bindsym d exec --no-startup-id notify-send -i microphone-sensitivity-low-symbolic "Mic volume down" "Current mic volume $(ponymix -t source decrease 4)%" -t 5000
    # reset mic volume to 90
    bindsym i exec --no-startup-id notify-send -i audio-input-microphone "Microphone volume reset" "Microphone volume is $(ponymix -t source set-volume 90)%" -t 5000, mode "default"

    # global volume
    bindsym k exec --no-startup-id notify-send -i audio-volume-high "Global volume up" "Current volume $(ponymix increase 4)%" -t 5000
    bindsym j exec --no-startup-id notify-send -i audio-volume-medium "Global volume down" "Current volume $(ponymix decrease 4)%" -t 5000

    # global mute / unmute
    bindsym m exec --no-startup-id notify-send -i microphone-sensitivity-muted-symbolic "Microphone muted" "Once was volume $(ponymix -t source mute)%" -t 5000, mode "default"
    bindsym w exec --no-startup-id notify-send -i microphone-sensitivity-high-symbolic "Microphone unmuted" "Microphone volume is $(ponymix -t source unmute)%" -t 5000, mode "default"

    # combo commands
    # leave desk
    bindsym l exec --no-startup-id $HOME/dotfiles/sh-scripts/paswitch.sh speakers, exec --no-startup-id notify-send -i microphone-sensitivity-muted-symbolic "Microphone muted" "Once was volume $(ponymix -t source mute)%" -t 500, mode "default"
    # return to desk
    bindsym r exec --no-startup-id $HOME/dotfiles/sh-scripts/paswitch.sh usb, exec --no-startup-id notify-send -i microphone-sensitivity-high-symbolic "Microphone unmuted" "Microphone volume is $(ponymix -t source unmute)%" -t 500, mode "default"

    # playerctl
    bindsym space exec --no-startup-id playerctl play-pause, mode "default"
    bindsym p exec --no-startup-id playerctl previous
    bindsym n exec --no-startup-id playerctl next

    # control Spotify volume
    bindsym Shift+k exec --no-startup-id notify-send -i audio-headphones "Spotify volume up" "Spotify volume $(ponymix increase 10 -d Spotify --sink-input)%" -t 500
    bindsym Shift+j exec --no-startup-id notify-send -i audio-headphones "Spotify volume down" "Spotify volume $(ponymix decrease 10 -d Spotify --sink-input)%" -t 500

    # sometimes Spotify creates an extra sink for no apparent reason, so make a keybind to kill it
    bindsym z exec --no-startup-id notify-send -i dialog-warning-symbolic "Spotify stream killed" "$(ponymix kill -d Spotify)" -t 500

    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+o mode "ponymix"

# Start i3bar to display a workspace bar (plus the system information i3status
# finds out, if available)
bar {
    id main-bar
    status_command i3status
    font pango:DejaVu Sans Mono 16
    strip_workspace_numbers yes
    wheel_up_cmd nop
    wheel_down_cmd nop
    tray_output DP-0
    tray_output primary
    tray_output DP-2
}

# Settings
focus_follows_mouse no
workspace_auto_back_and_forth yes
workspace_layout stacked

# Run programs
bindsym $mod+g exec $HOME/dotfiles/sh-scripts/fuzzy-lock.sh &
bindsym $mod+Return exec xfce4-terminal
bindsym $mod+semicolon exec i3-sensible-terminal -e "python $HOME/dotfiles/py-scripts/export-ggb-clean-asy.py"

# The Endor box is missing DP-0 and DP-4 is actually HDMI-0 compared to ArchMajestic
workspace $WS1 output DP-4 HDMI-0
workspace $WS2 output DP-0
workspace $WS9 output DP-2
workspace $WS0 output DP-4 HDMI-0
workspace $WS7 output HDMI-0

# Exec startup
# exec xfce4-power-manager --sm-client-disable
# exec nm-applet --no-startup-id

# vim: expandtab
